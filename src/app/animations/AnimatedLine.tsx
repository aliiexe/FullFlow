'use client';
import gsap from 'gsap';
import '../styles/line.css';
import { useRef, useEffect, useState } from 'react';
import { ScrollTrigger } from 'gsap/ScrollTrigger';

const AnimatedLine = () => {
  const containerRef = useRef<HTMLDivElement>(null);
  const largeSvgRef = useRef<SVGSVGElement>(null);
  const smallSvgRef = useRef<SVGSVGElement>(null);
  const [isMobile, setIsMobile] = useState(false);

  // Check screen size
  useEffect(() => {
    const checkScreenSize = () => {
      setIsMobile(window.innerWidth <= 425);
    };
    
    // Initial check
    checkScreenSize();
    
    // Listen for resize events
    window.addEventListener('resize', checkScreenSize);
    return () => window.removeEventListener('resize', checkScreenSize);
  }, []);

  useEffect(() => {
    gsap.registerPlugin(ScrollTrigger);
  
    // Determine which SVG to animate based on screen size
    const svg = isMobile ? smallSvgRef.current : largeSvgRef.current;
    if (!svg) return;
    
    const paths = svg.querySelectorAll('path');
    if (!paths.length) return;
  
    // Define different scroll configurations based on screen size
    const scrollConfig = {
      trigger: containerRef.current,
      start: isMobile ? "top 10%" : "top 15%", // Start earlier on mobile
      end: isMobile ? "bottom 90%" : "bottom bottom", // End sooner on mobile
      scrub: isMobile ? 0.8 : 1, // Slightly faster scrub on mobile
      // markers: true, // Uncomment to debug
    };
    
    paths.forEach((path) => {
      const pathLength = path.getTotalLength();
      gsap.set(path, { strokeDasharray: pathLength });
      gsap.fromTo(
        path,
        { strokeDashoffset: pathLength },
        {
          strokeDashoffset: 0,
          duration: 10, // Slightly shorter duration on mobile
          ease: "none",
          scrollTrigger: scrollConfig,
        }
      );
    });
  
    return () => {
      ScrollTrigger.getAll().forEach((trigger) => trigger.kill());
    };
  }, [isMobile]); // Re-run when screen size changes

  return (
    <>
      <div className="svg-container" ref={containerRef}>
        {/* Large SVG for desktop - hidden on mobile */}
        <svg 
          className="gradient-line large-line" 
          ref={largeSvgRef} 
          width="100%" 
          height="7600" 
          viewBox="0 0 1898 7600" 
          fill="none" 
          xmlns="http://www.w3.org/2000/svg"
          style={{ display: isMobile ? 'none' : 'block' }}
        >
          {/* SVG content stays the same */}
          <defs>
            <linearGradient id="lineGradientLarge" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%" stopColor="#FF0080" />
              <stop offset="25%" stopColor="#F352F0" />
              <stop offset="50%" stopColor="#EA8221" />
              <stop offset="75%" stopColor="#FF7600" />
              <stop offset="100%" stopColor="#FFCC00" />
            </linearGradient>
          </defs>

          <path
            d="M1890.44 28C1890.44 28 1251.52 144.756 1218.86 480.339C1198.12 693.536 1318.49 1031.69 1423.39 981.476C1508.14 940.907 1540.79 812.092 1485.4 730.908C1292.42 448.1 907.722 930.402 512.526 1094.47C405.316 1138.98 287.04 1131.46 283.5 1004C280.495 895.806 417.227 858.412 512.526 886.666C649.884 927.389 705.66 1190.62 600.55 1295.78C545.155 1351.2 504.974 1356.56 438.519 1394.65C365.569 1436.47 351.191 1506.33 275 1540.5C209.33 1569.95 80.1728 1595.4 19.7255 1636.13C-51.1003 1683.86 -80.4614 1747.06 -87.2869 1837.9C-99.498 2000.43 167.251 2040.95 291.757 2130.14C752.008 2459.87 1307.74 1322.85 1663.42 1782.53C1777.8 1930.36 1912.64 2057.74 1845.44 2237.06C1786.49 2394.36 1647.17 2404.94 1496.4 2444.86C1358.96 2481.25 1272.59 2412.31 1134.35 2444.86C972.887 2482.89 912.485 2594.88 755.311 2650.47C665.822 2682.12 613.097 2729.84 520.784 2710.23C433.526 2691.7 302.768 2664.37 331.262 2572.07C355.817 2492.51 448.775 2406.48 520.784 2516.69C592.792 2626.89 150.004 2690.47 139.739 2915.84C135.968 2998.64 141.708 3051.69 179.244 3123.64C214.774 3191.76 303.327 3183.48 312.759 3261.27C322.189 3339.02 237.185 3357.16 216.748 3432.33C138.542 3720 704.877 3351.68 909.328 3551.31C909.328 3551.31 1079.62 3890.34 1272.5 4016.5C1457.38 4137.43 1615.29 4251.17 1818.5 4164.5C1997.09 4088.34 2101.16 3946.08 2096 3752C2090.65 3550.71 1943.81 3458.27 1775 3348.5C1296.25 3037.2 1090.62 4076.73 519.999 4099C386.67 4104.2 295.643 4008.77 179.244 4074C24.5022 4160.72 40.6747 4340.99 72.4991 4515.5C147.911 4929.01 1055.49 4211.48 1143.5 4622.5C1195.43 4865.06 1087.97 5044.06 904.499 5211C791.21 5314.08 634.417 5257.33 554.499 5388C403.97 5634.11 1351.45 5419.89 1232 5682.5C1161.1 5838.37 805.836 5730.29 848.999 5896C867.04 5965.26 936.704 5972.93 962.999 6039.5C1019.23 6181.86 949.424 6298.99 848.999 6414.5C630.836 6665.44 320.018 6070.55 20.9991 6216C-214.472 6330.54 -475.572 6539.32 -354.501 6771.5C-255.399 6961.55 -38.8329 6887.9 171.999 6926.5C833.113 7047.53 1371.4 6213.59 1872.5 6661.5C2077.45 6844.69 2200.06 6998.49 2222 7272.5C2247.59 7592.13 1869 7593.5 1640 7555.5C1411 7517.5 1313.25 7097.98 764.499 7143.5C433.681 7170.94 144.27 7270.84 -26.5 7555.5"            
            stroke="url(#lineGradientLarge)"
            strokeWidth="50"
            strokeLinecap="round"
            fill="none"
          />
          <path
            d="M1890.44 28C1890.44 28 1251.52 144.756 1218.86 480.339C1198.12 693.536 1318.49 1031.69 1423.39 981.476C1508.14 940.907 1540.79 812.092 1485.4 730.908C1292.42 448.1 907.722 930.402 512.526 1094.47C405.316 1138.98 287.04 1131.46 283.5 1004C280.495 895.806 417.227 858.412 512.526 886.666C649.884 927.389 705.66 1190.62 600.55 1295.78C545.155 1351.2 504.974 1356.56 438.519 1394.65C365.569 1436.47 351.191 1506.33 275 1540.5C209.33 1569.95 80.1728 1595.4 19.7255 1636.13C-51.1003 1683.86 -80.4614 1747.06 -87.2869 1837.9C-99.498 2000.43 167.251 2040.95 291.757 2130.14C752.008 2459.87 1307.74 1322.85 1663.42 1782.53C1777.8 1930.36 1912.64 2057.74 1845.44 2237.06C1786.49 2394.36 1647.17 2404.94 1496.4 2444.86C1358.96 2481.25 1272.59 2412.31 1134.35 2444.86C972.887 2482.89 912.485 2594.88 755.311 2650.47C665.822 2682.12 613.097 2729.84 520.784 2710.23C433.526 2691.7 302.768 2664.37 331.262 2572.07C355.817 2492.51 448.775 2406.48 520.784 2516.69C592.792 2626.89 150.004 2690.47 139.739 2915.84C135.968 2998.64 141.708 3051.69 179.244 3123.64C214.774 3191.76 303.327 3183.48 312.759 3261.27C322.189 3339.02 237.185 3357.16 216.748 3432.33C138.542 3720 704.877 3351.68 909.328 3551.31C909.328 3551.31 1079.62 3890.34 1272.5 4016.5C1457.38 4137.43 1615.29 4251.17 1818.5 4164.5C1997.09 4088.34 2101.16 3946.08 2096 3752C2090.65 3550.71 1943.81 3458.27 1775 3348.5C1296.25 3037.2 1090.62 4076.73 519.999 4099C386.67 4104.2 295.643 4008.77 179.244 4074C24.5022 4160.72 40.6747 4340.99 72.4991 4515.5C147.911 4929.01 1055.49 4211.48 1143.5 4622.5C1195.43 4865.06 1087.97 5044.06 904.499 5211C791.21 5314.08 634.417 5257.33 554.499 5388C403.97 5634.11 1351.45 5419.89 1232 5682.5C1161.1 5838.37 805.836 5730.29 848.999 5896C867.04 5965.26 936.704 5972.93 962.999 6039.5C1019.23 6181.86 949.424 6298.99 848.999 6414.5C630.836 6665.44 320.018 6070.55 20.9991 6216C-214.472 6330.54 -475.572 6539.32 -354.501 6771.5C-255.399 6961.55 -38.8329 6887.9 171.999 6926.5C833.113 7047.53 1371.4 6213.59 1872.5 6661.5C2077.45 6844.69 2200.06 6998.49 2222 7272.5C2247.59 7592.13 1869 7593.5 1640 7555.5C1411 7517.5 1313.25 7097.98 764.499 7143.5C433.681 7170.94 144.27 7270.84 -26.5 7555.5"            
            stroke="url(#lineGradientLarge)"
            // stroke="url(#lineGradientLarge)"
            strokeWidth="35"
            strokeLinecap="round"
            fill="none"
          />
        </svg>
        
        {/* Small SVG for mobile - hidden on desktop */}
        <svg 
          className="gradient-line small-line" 
          ref={smallSvgRef} 
          width="100%" 
          height="10550" 
          viewBox="0 0 430 10550" 
          fill="none" 
          xmlns="http://www.w3.org/2000/svg"
          style={{ display: isMobile ? 'block' : 'none' }}
        >
          {/* SVG content stays the same */}
          <defs>
            <linearGradient id="lineGradientSmall" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%" stopColor="#FF0080" />
              <stop offset="25%" stopColor="#F352F0" />
              <stop offset="50%" stopColor="#EA8221" />
              <stop offset="75%" stopColor="#FF7600" />
              <stop offset="100%" stopColor="#FFCC00" />
            </linearGradient>
          </defs>
          <path
            d="M838.174 0C838.174 0 424.696 96.2926 403.563 373.059C390.137 548.889 468.035 827.777 535.92 786.362C590.765 752.904 611.898 646.666 576.048 579.711C451.164 346.47 267.096 841.425 11.3449 976.735C-58.0364 1013.44 -134.579 1007.25 -136.87 902.124C-138.814 812.893 -50.3285 782.053 11.3449 805.355C100.236 838.94 105.902 1046.01 37.8807 1132.74C2.03189 1178.45 -37.8779 1152.42 -80.8847 1183.84C-128.094 1218.33 -137.399 1275.94 -186.706 1304.12C-229.204 1328.41 -264.088 1292.69 -303.207 1326.28C-349.042 1365.64 -368.043 1417.77 -372.46 1492.69C-380.362 1626.72 -276.989 1660.14 -196.414 1733.71C101.437 2005.65 461.076 1067.91 691.254 1447.02C765.279 1568.93 852.537 1674 809.049 1821.88C770.899 1951.62 680.74 1960.34 583.168 1993.26C494.227 2023.28 438.33 1966.41 348.872 1993.26C244.379 2024.63 205.289 2116.99 103.574 2162.84C45.6616 2188.94 11.5406 2228.3 -48.1999 2212.12C-104.669 2196.84 -189.289 2174.3 -170.849 2098.17C-154.958 2032.56 -94.8001 1961.61 -48.1999 2052.5C-1.59956 2143.39 -288.15 2195.82 -294.793 2381.7C-297.233 2449.98 -293.519 2493.73 -269.227 2553.08C-246.234 2609.25 -188.927 2602.43 -182.823 2666.58C-176.721 2730.71 -231.731 2844.8 -244.956 2906.8C-295.568 3144.04 70.9357 2840.28 203.247 3004.92C203.247 3004.92 313.454 3284.53 438.273 3388.58C557.918 3488.32 660.108 3582.11 791.616 3510.64C907.189 3447.82 974.539 3330.5 971.201 3170.44C967.739 3004.43 872.71 2928.19 763.465 2837.66C453.645 2580.92 320.571 3438.25 -48.7075 3456.62C-134.992 3460.91 -193.9 3382.2 -269.227 3436C-369.368 3507.52 -358.903 3557.06 -338.307 3700.99C-289.505 4042.02 297.838 3450.25 354.79 3789.23C388.4 3989.28 318.909 4272.38 200.177 4410.06C126.862 4495.07 16.0892 4445.83 -26.3256 4556.04C-122.456 4805.81 490.856 4633.78 412.118 4798.92C352.482 4923.99 136.326 4838.33 164.26 4975C175.935 5032.12 221.018 5038.45 238.035 5093.35C308.094 5319.37 262.916 5640.5 197.926 5735.77C56.742 5942.73 -144.404 5452.1 -337.914 5572.06C-490.299 5666.52 -692.934 6102.1 -614.583 6293.58C-550.449 6450.32 -410.299 6389.58 -273.859 6421.42C153.981 6521.24 502.335 5833.46 826.62 6202.86C959.252 6353.95 1047 6720.9 1061.2 6946.89C1077.77 7210.5 832.759 7211.63 684.561 7180.29C536.363 7148.95 473.102 6802.96 117.98 6840.5C-96.1083 6863.13 -335.416 6980.75 -393.915 7180.29C-424.382 7284.22 -466.277 7747.1 -371.581 7824C-228.221 7940.43 -65.7029 7568.05 110.707 7652.5C225.257 7707.34 151.173 7833.33 260.78 7894C305.301 7918.64 334.136 7943.16 388.407 7938.5C488.412 7929.92 522.447 7882 419.833 7815.5C194.593 7669.53 311.442 8658.07 39.3731 8573.5C-51.7234 8545.18 -143.642 8448.96 -116.473 8375.5C-87.8156 8298.01 47.2581 8358.6 148.401 8375.5C351.274 8409.4 652.727 8475.17 572.968 8624.5C549.495 8668.45 528.972 8697.96 474.202 8719C416.016 8741.36 366.934 8697.71 308.094 8719C242.756 8742.64 192.747 9003.42 4.48272 9097.5C-52.3953 9125.92 -106.409 9116.13 -152.004 9155C-267.208 9253.2 -130.393 9636.72 154.814 9758.5C255.868 9801.65 349.739 9763.63 438.928 9820.5C526.942 9876.62 541.744 9936.76 572.968 10022C637.846 10199.1 700.277 10414.7 483.822 10488.5C228.528 10575.6 504.008 9969.07 225.362 9970C60.036 9970.55 -22.1049 10053.8 -126.093 10154C-394.714 10412.8 -338.754 10910.4 75.288 10992C230.741 11022.6 361.824 10878.9 483.822 10960C575.029 11020.6 593.129 11096.9 572.968 11189C527.885 11395 70.1988 10939.9 -103.646 11099C-207.872 11194.4 -296.482 11401.3 -170.986 11548.5C-87.9516 11645.9 8.12704 11698.7 158.021 11703C317.669 11707.5 371.673 11494.9 515.889 11548.5C611.099 11583.9 624.133 11649.4 659.118 11727C739.478 11905.2 752.165 12107.5 542.394 12202C340.072 12293.1 41.762 12240.3 -30.3229 12067C-66.2289 11980.7 -111.105 11858.2 1.74415 11836C98.8483 11816.9 156.93 11892.7 199.277 11963.5C283.171 12103.7 15.6581 12159 -77.782 12295.5C-160.494 12416.3 -202.694 12486.7 -258.649 12616.5C-292.433 12694.9 -372.129 12744.3 -331.121 12820.5C-272.654 12929.2 -96.4432 12839.8 54.3245 12848.5C186.171 12856.1 280.638 12947.1 409.636 12924.5C481.294 12912 589.509 12864.6 567.396 12810C549.44 12765.7 431.767 12723 341.013 12743.5C204.395 12774.3 179.511 12945.6 280.718 13023.5C344.046 13072.2 429.2 13026.1 501.98 13066C643.846 13143.8 668.686 13292.1 577.658 13407.2C465.815 13548.7 242.166 13403.7 33.1603 13436.2C-56.3731 13450.2 -118.804 13440.5 -193.233 13481.7C-353.643 13570.6 -348.751 13750.9 -230.431 13873.5C-169.865 13936.2 -111.268 13961 -14.9403 13984C106.276 14012.9 190.018 14001.7 308.936 13967.5C422.493 13934.8 615.054 13909.4 559.7 13825.5C519.48 13764.5 432.036 13778.1 344.21 13774.5C22.0665 13761.3 71.7991 14104.9 -85.4877 14324.5C-122.65 14376.4 -180.108 14398.6 -179.123 14458C-177.961 14528.1 -102.991 14550.6 -43.1592 14603C82.6614 14713.2 156.302 14828.7 345.502 14828.5C436.543 14828.4 501.61 14824 568.689 14776C679.994 14696.4 682.59 14559.2 577.658 14474.5C497.308 14409.6 404.473 14416.5 289.055 14422.5C-45.8279 14440 -133.801 14916.7 25.4737 15147"
            stroke="url(#lineGradientSmall)"
            strokeWidth="30"
            strokeLinecap="round"
            fill="none"
          />
          <path
            d="M838.174 0C838.174 0 424.696 96.2926 403.563 373.059C390.137 548.889 468.035 827.777 535.92 786.362C590.765 752.904 611.898 646.666 576.048 579.711C451.164 346.47 267.096 841.425 11.3449 976.735C-58.0364 1013.44 -134.579 1007.25 -136.87 902.124C-138.814 812.893 -50.3285 782.053 11.3449 805.355C100.236 838.94 105.902 1046.01 37.8807 1132.74C2.03189 1178.45 -37.8779 1152.42 -80.8847 1183.84C-128.094 1218.33 -137.399 1275.94 -186.706 1304.12C-229.204 1328.41 -264.088 1292.69 -303.207 1326.28C-349.042 1365.64 -368.043 1417.77 -372.46 1492.69C-380.362 1626.72 -276.989 1660.14 -196.414 1733.71C101.437 2005.65 461.076 1067.91 691.254 1447.02C765.279 1568.93 852.537 1674 809.049 1821.88C770.899 1951.62 680.74 1960.34 583.168 1993.26C494.227 2023.28 438.33 1966.41 348.872 1993.26C244.379 2024.63 205.289 2116.99 103.574 2162.84C45.6616 2188.94 11.5406 2228.3 -48.1999 2212.12C-104.669 2196.84 -189.289 2174.3 -170.849 2098.17C-154.958 2032.56 -94.8001 1961.61 -48.1999 2052.5C-1.59956 2143.39 -288.15 2195.82 -294.793 2381.7C-297.233 2449.98 -293.519 2493.73 -269.227 2553.08C-246.234 2609.25 -188.927 2602.43 -182.823 2666.58C-176.721 2730.71 -231.731 2844.8 -244.956 2906.8C-295.568 3144.04 70.9357 2840.28 203.247 3004.92C203.247 3004.92 313.454 3284.53 438.273 3388.58C557.918 3488.32 660.108 3582.11 791.616 3510.64C907.189 3447.82 974.539 3330.5 971.201 3170.44C967.739 3004.43 872.71 2928.19 763.465 2837.66C453.645 2580.92 320.571 3438.25 -48.7075 3456.62C-134.992 3460.91 -193.9 3382.2 -269.227 3436C-369.368 3507.52 -358.903 3557.06 -338.307 3700.99C-289.505 4042.02 297.838 3450.25 354.79 3789.23C388.4 3989.28 318.909 4272.38 200.177 4410.06C126.862 4495.07 16.0892 4445.83 -26.3256 4556.04C-122.456 4805.81 490.856 4633.78 412.118 4798.92C352.482 4923.99 136.326 4838.33 164.26 4975C175.935 5032.12 221.018 5038.45 238.035 5093.35C308.094 5319.37 262.916 5640.5 197.926 5735.77C56.742 5942.73 -144.404 5452.1 -337.914 5572.06C-490.299 5666.52 -692.934 6102.1 -614.583 6293.58C-550.449 6450.32 -410.299 6389.58 -273.859 6421.42C153.981 6521.24 502.335 5833.46 826.62 6202.86C959.252 6353.95 1047 6720.9 1061.2 6946.89C1077.77 7210.5 832.759 7211.63 684.561 7180.29C536.363 7148.95 473.102 6802.96 117.98 6840.5C-96.1083 6863.13 -335.416 6980.75 -393.915 7180.29C-424.382 7284.22 -466.277 7747.1 -371.581 7824C-228.221 7940.43 -65.7029 7568.05 110.707 7652.5C225.257 7707.34 151.173 7833.33 260.78 7894C305.301 7918.64 334.136 7943.16 388.407 7938.5C488.412 7929.92 522.447 7882 419.833 7815.5C194.593 7669.53 311.442 8658.07 39.3731 8573.5C-51.7234 8545.18 -143.642 8448.96 -116.473 8375.5C-87.8156 8298.01 47.2581 8358.6 148.401 8375.5C351.274 8409.4 652.727 8475.17 572.968 8624.5C549.495 8668.45 528.972 8697.96 474.202 8719C416.016 8741.36 366.934 8697.71 308.094 8719C242.756 8742.64 192.747 9003.42 4.48272 9097.5C-52.3953 9125.92 -106.409 9116.13 -152.004 9155C-267.208 9253.2 -130.393 9636.72 154.814 9758.5C255.868 9801.65 349.739 9763.63 438.928 9820.5C526.942 9876.62 541.744 9936.76 572.968 10022C637.846 10199.1 700.277 10414.7 483.822 10488.5C228.528 10575.6 504.008 9969.07 225.362 9970C60.036 9970.55 -22.1049 10053.8 -126.093 10154C-394.714 10412.8 -338.754 10910.4 75.288 10992C230.741 11022.6 361.824 10878.9 483.822 10960C575.029 11020.6 593.129 11096.9 572.968 11189C527.885 11395 70.1988 10939.9 -103.646 11099C-207.872 11194.4 -296.482 11401.3 -170.986 11548.5C-87.9516 11645.9 8.12704 11698.7 158.021 11703C317.669 11707.5 371.673 11494.9 515.889 11548.5C611.099 11583.9 624.133 11649.4 659.118 11727C739.478 11905.2 752.165 12107.5 542.394 12202C340.072 12293.1 41.762 12240.3 -30.3229 12067C-66.2289 11980.7 -111.105 11858.2 1.74415 11836C98.8483 11816.9 156.93 11892.7 199.277 11963.5C283.171 12103.7 15.6581 12159 -77.782 12295.5C-160.494 12416.3 -202.694 12486.7 -258.649 12616.5C-292.433 12694.9 -372.129 12744.3 -331.121 12820.5C-272.654 12929.2 -96.4432 12839.8 54.3245 12848.5C186.171 12856.1 280.638 12947.1 409.636 12924.5C481.294 12912 589.509 12864.6 567.396 12810C549.44 12765.7 431.767 12723 341.013 12743.5C204.395 12774.3 179.511 12945.6 280.718 13023.5C344.046 13072.2 429.2 13026.1 501.98 13066C643.846 13143.8 668.686 13292.1 577.658 13407.2C465.815 13548.7 242.166 13403.7 33.1603 13436.2C-56.3731 13450.2 -118.804 13440.5 -193.233 13481.7C-353.643 13570.6 -348.751 13750.9 -230.431 13873.5C-169.865 13936.2 -111.268 13961 -14.9403 13984C106.276 14012.9 190.018 14001.7 308.936 13967.5C422.493 13934.8 615.054 13909.4 559.7 13825.5C519.48 13764.5 432.036 13778.1 344.21 13774.5C22.0665 13761.3 71.7991 14104.9 -85.4877 14324.5C-122.65 14376.4 -180.108 14398.6 -179.123 14458C-177.961 14528.1 -102.991 14550.6 -43.1592 14603C82.6614 14713.2 156.302 14828.7 345.502 14828.5C436.543 14828.4 501.61 14824 568.689 14776C679.994 14696.4 682.59 14559.2 577.658 14474.5C497.308 14409.6 404.473 14416.5 289.055 14422.5C-45.8279 14440 -133.801 14916.7 25.4737 15147"
            stroke="url(#lineGradientSmall)"
            strokeWidth="20"
            strokeLinecap="round"
            fill="none"
          />
        </svg>
      </div>
    </>
  );
};

export default AnimatedLine;